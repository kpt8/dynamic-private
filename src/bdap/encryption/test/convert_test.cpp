#include <stdio.h>
#include <stdbool.h>
#include <string.h>
#include "curve25519.h"
#include "ed25519.h"
#include "utils.h"

typedef struct
{
    const char *ed25519_sk_hex;
    const char *ed25519_pk_hex;
    const char *curve25519_sk_hex;
    const char *curve25519_pk_hex;
} ed25519_curve25519_test_vectors;

static ed25519_curve25519_test_vectors test_vectors[] =
{
 	{
		"76df10c87abe776b95c85d69b42418d515e0eda1bb82c5e27851f8574380fb206a2b8851bcda0a3244e23966cdcfb21b86663da189513a55a1fd5ac6a9cd4f62",
		"6a2b8851bcda0a3244e23966cdcfb21b86663da189513a55a1fd5ac6a9cd4f62",
		"d851f176e0de25113e6bf0fe53b19d3ab68e0f60ceef13870dd1f565361a1d50",
		"bd935a00c9066fa4e0e384985294b6f411c964d1f8004e5bfb60259d064b5a47"
	},
	{
		"b4346905ca10ccf05144f6165cfc3c735cdf40711a60cf66831e4bf3dca9fe6d4a2ca861c88a8589661cec45371573a1b82aae07ff5bf915181e783d1e02e4ce",
		"4a2ca861c88a8589661cec45371573a1b82aae07ff5bf915181e783d1e02e4ce",
		"f8a1e15ae94b1ae32280c767a9795c2c7bc3af77e253caa6e97356ef5ce52f66",
		"9adac46194138e7b28b8dcd8b3ede5cac1a239a1a934f6cd5371216352cb852b"
	},
	{
		"27e95493e8abce13e2712f48d4fe96d87691a01ba2a16e04e7c57adfcbb7e3ea355daae771fed1616bb7e754b0561bdc33392f650db51e51c13dd872149a1b6d",
		"355daae771fed1616bb7e754b0561bdc33392f650db51e51c13dd872149a1b6d",
		"c004678a27a1847ffe7b47f8ed33746463f48488c7eae5af09e7a90ac4c37942",
		"b817bce51a80e7e3a6ff874ff3eb7feac24e0d9a5230df5b5b11823dc98af84b"
	},
	{
		"c167cb07c3c3fb929bca552ebd971e5dbfaabbc6877bed2967f6b79d722d0f93a81b6a6ea532b4473d4ca5298ea103d89fcf46702eb2ee468b8455b63542cbe3",
		"a81b6a6ea532b4473d4ca5298ea103d89fcf46702eb2ee468b8455b63542cbe3",
		"906b20115b76859a51ca1714a38475e7daeefeb66d41dd512d84173ed6be2752",
		"5c51452959a39accf79be1428c822314209a577bdde4aa0012f499156bdb9b5b"
	},
	{
		"8006225fb7ed23c57fe696df4f9d86ab52c45a17249648ed7c86000048eb269f2cf1e346111751317cb820785c23c245d720cc897ea342dcb5ea3e3ffe70d708",
		"2cf1e346111751317cb820785c23c245d720cc897ea342dcb5ea3e3ffe70d708",
		"38ce8a6a2b6a4b9225ec9b12a7011e9812562b010c58fa774b048fef6ab6504b",
		"1666b7c26dfb6215543534c6ae4491fc5b4bc044e42fbc32805435b343b10763"
	},
	{
		"781ba34241ffc3a65cb2a2e0eb7404df912c9a22f83a3fdf63fbabd1113322a98a51cbd7cd04777523953aaae8b205b9c8a13b23483dab894225136725995e5d",
		"8a51cbd7cd04777523953aaae8b205b9c8a13b23483dab894225136725995e5d",
		"9062f6576eb86b0f62b286d198cdcdd0bacc221df863a686fb8d9dac50111a67",
		"814fa68380ba39f0f56481c72c1f4ba33d47cdab5d2eaf240c670daf59b6d32c"
	},
	{
		"dfb497bf2ba64faab31b135eca5d0108cba324370cff35deb093d5c59b91f0eff3e3169cee04825cb640a168c07c3c4b09d64f6fd2469a5e9003a1d0704967a8",
		"f3e3169cee04825cb640a168c07c3c4b09d64f6fd2469a5e9003a1d0704967a8",
		"b80667d878762a5703a56e8d609642b340a0d041ebd3431396c3df755a16e843",
		"90c51e260fe2a9bd1ecac72dbe0378e2d57baf0bd3ffbb4c32675a90fb7e6b6c"
	},
	{
		"793dd6f277405f9c381ac13e983dee04df4da8cd17195d5e9e5d31f6024297dd287d22511fa6073bfba0c94f34930a21a3b90c536da958be13e239c47d2780f7",
		"287d22511fa6073bfba0c94f34930a21a3b90c536da958be13e239c47d2780f7",
		"103194f4fb97de35f0351402792592c8280736149930fa6d2ed824e31b436b69",
		"b9a0e2ad78ec8c0e075d7f18578713b0d00b4e93729794e048c91194bc507750"
	},
	{
		"48d4da1d243c7db94b6f02cd3e5ea53ef7855201bdd2d8e8bb28300a74ef337ab3db9a9263424d7fa6b321ec505b9bee4990a8d1899e3c32971e72be1e07cabf",
		"b3db9a9263424d7fa6b321ec505b9bee4990a8d1899e3c32971e72be1e07cabf",
		"484ec4d7adb940a40c11be49ee939ca5966e6462206c12479897ed90bc1afd57",
		"3391ca84c56a879f9762c0adbba5071e8249611a23c7658b64f671847b788429"
	},
	{
		"bc42e4e365e5713da9267eeb7f29c49cb7803757fab57e2db17ae09c0e374a0b92c3658ff3bc7f2d20f3c5a6ed87ee1700b1a2b1b2f56c4407192029cd09a5b5",
		"92c3658ff3bc7f2d20f3c5a6ed87ee1700b1a2b1b2f56c4407192029cd09a5b5",
		"88a22c2b8e00213f80abdc4a77dca0b58e4d0b9a4a9571b10b03cb74692c0b71",
		"c06e74e4e52a555b26e33d002c22732d8ddb955059ab32a668e094665175a230"
	},
	{
		"a52ba9ef32bd901be457cb403566b490f5dea1a61a52a314b3b34fe482b51489666044da361b41abd521936a92cfa2abea02ce3efdb538a7eafce19912544c2b",
		"666044da361b41abd521936a92cfa2abea02ce3efdb538a7eafce19912544c2b",
		"6014b561b81afc52a418ac1287be55ea61be90ec7d1dd2568333e4a43b878f58",
		"4861a7395c8472544789cd0064e3b5ebbcdacbefaf785f9253d6bac7aab7ce36"
	},
	{
		"6cb76e48eed35393dd83d471730298cbe5a5346232b3077be569560646ef50ad29aa83ef3310700625e742a586c22e6e7d098700e12239063eb6e02ec7aeaa89",
		"29aa83ef3310700625e742a586c22e6e7d098700e12239063eb6e02ec7aeaa89",
		"50ad72e39873a70f859d04a5be352e12526eab6339d68b7b2440681bcfcba264",
		"aef43df82ef295e3c5e37f78c30ab927a1cff9bef429e2c1a7cdd5648ed2576c"
	},
	{
		"d64ad299b1e313b1cc5e1b4db695abee11dae52a9dccddaefa486ce0832269ffb8dc9b7284e859f6f1f13f083f37d90732014fb21ae499d230bab42f655161da",
		"b8dc9b7284e859f6f1f13f083f37d90732014fb21ae499d230bab42f655161da",
		"d068e5ccb8fb32216b39ad455efb455fd068a57698e14ab77844654804be4b43",
		"cc9a7074b329d9606eaf8cf83ed36d981f781225b03c635b67523f7380104000"
	},
	{
		"0ef5b05b6c3a201a7407f595cf3199eb9a47fbde3166a7d5a0f247fa56d575e157f381bfbc2adb995f939ef9930ca636dcbeffff9149e204f5bd102126c0dc99",
		"57f381bfbc2adb995f939ef9930ca636dcbeffff9149e204f5bd102126c0dc99",
		"50931cf0709401173c78b2fc165634b687ceba3c7efb146857019a61c7141767",
		"998ea5fd27ceaa1a831e842f9abcd541b367feedd5677d24540f0d0d8a60b239"
	},
	{
		"3be9b5f0384db8a4b550648c9f83adc1282af867e49158b2bc881237256341cc9a02df9a696644a35e0cb1d65543250088d3cc10dc09123ffa8aecd17c39150e",
		"9a02df9a696644a35e0cb1d65543250088d3cc10dc09123ffa8aecd17c39150e",
		"d01131d9c1479ddba465d896c9c9f9f621a8f8f5389dd1b925d225bfa55d8066",
		"87424d5038b64d5a48607604c0a8d65f831ebe3be9d7ed42a596918835b5651a"
	},
	{
		"89b179e1da20f462e8a5b2471ee23e37201666fd65220dfd18bfb9d111df6265cf9dd87e5517cdffaf32490d39d6ceeb4bd4cbf9c3e27831b18eea61cc8546bb",
		"cf9dd87e5517cdffaf32490d39d6ceeb4bd4cbf9c3e27831b18eea61cc8546bb",
		"4022388942817a3be4519621f0fc194f674c068e2b555ceb2533fb633878984d",
		"2f99cb48127be4f7636ee647142a7d60e663b54d81337ab3b1bcf831d8d72d1e"
	},
	{
		"c3952af5d5c500fe8511cbc0b197837d6ca0943f3a6bbe09cbb762a139aa5dfd8f9c00d7ef9b75c443baa0fe56419df053ddbd7926154553e5acd5fcc30f9bc4",
		"8f9c00d7ef9b75c443baa0fe56419df053ddbd7926154553e5acd5fcc30f9bc4",
		"887cafe9a0802e56c3efeb16b901f488322b971e48aca1ff2d63aa074d047c59",
		"01ce686bff9e6f3ed53ee5a2593e4ad18d7b1ca44f24d84a01274e2e71635f6b"
	},
	{
		"cbefed0f343ab338dc7dd30fe92d8b066c0eca3b314f9a611760e8a2bedfda15e4d295c3a75291ad7f9c9f01dd8cac9f3fb644ae8cd16b117a6f84c50c8cc6cb",
		"e4d295c3a75291ad7f9c9f01dd8cac9f3fb644ae8cd16b117a6f84c50c8cc6cb",
		"a0e3de6521a35e4596a5fc8d9656f55dccc5c7f1c8ab783f8ea1182bf7cdf07d",
		"6bd5fc07489099959015503b331b70c621baf8a7aefdd71ee254e08336df572a"
	},
	{
		"e722c99c354183e50b4a48098cec72096f4fcd327b3bd4ef6a4fc58f42a636ed995858d0516647e162ce9d00c32bc412135679469bb1e94bfe03397873df7f04",
		"995858d0516647e162ce9d00c32bc412135679469bb1e94bfe03397873df7f04",
		"f8ef7e99946144bbe7a68c616341d6b36692058f5bef3e13c8272ae1b330376e",
		"b0b33f09205acf90c3bc0989c62fb751e5dba53f9464f7ef4be1ed785c965a54"
	},
	{
		"817af0885560b17ed6e524aa9ebadd3fec831fe57616ca4cbd582dea38aed2ebfe1b5bf7701a477b0a745076d28b00f21513363bc40394c9f1650f3bced05692",
		"fe1b5bf7701a477b0a745076d28b00f21513363bc40394c9f1650f3bced05692",
		"7054fa0b32ce86568a43f9c684ff09938d7de90a6ce291a0f5acf13d5b63fc50",
		"8f4ea09550624ef552b9cc4d3fcbbf5737953c153fe953145b378b8263315d20"
	},
	{
		"0fba83ed0eee1e831a1a295c18459b0a3d93ed8258000ed6bfe37655d29445439e47f7ded776ab86ba5718742b4f03582c826ad03add9727f831f4e24e419dbe",
		"9e47f7ded776ab86ba5718742b4f03582c826ad03add9727f831f4e24e419dbe",
		"d8c37a36aa8fc0768dee394910d0e6d24c01e5237d7c8d32d120c05428b67b4e",
		"20d19c85d1787c48cb4abe062c519ea0c94f5ee135b8c269ee6e5e3a1d5a7643"
	},
	{
		"fca35b241f16e598ab77c75833dd6a36e7f01c7dd209e5cc0f52dc7e16f01e6212140fe728c278e21a1388a5225e4695f43fa975695e09b931a3e315d4bd05be",
		"12140fe728c278e21a1388a5225e4695f43fa975695e09b931a3e315d4bd05be",
		"f8fc2d192c7d78b0ce88ce4c388a80894cfef3e14573cef9906a1b0d93acc279",
		"5c9ab325bff553f03345407495adebcba5d323fe418952949e902fdd120da63f"
	},
	{
		"496236b579a0c1bd3ae0a816aa8aa60ce4f2ed91b7449b7405c5a48d9a3ecd318fadbb736de062e8d592fe446f144a3befd4e1f64276c79fb496ae654b27d3a0",
		"8fadbb736de062e8d592fe446f144a3befd4e1f64276c79fb496ae654b27d3a0",
		"6026e8b42d3a5dd5031c8c3d5464d346c51297e1a715a358248ff55710ecdb63",
		"aa4036520a7c5454ba90112e29fdde0e70761adb5861ff657cb3cbf3b7ce857e"
	},
	{
		"b1243815b62d87c3d821c63d51f754f77312f8071893b21f347f76d0e6f4d46e3d8d65bd2f02dfc6b57f8b3e190334aeb5aab31e4abc6b6b003579bb4f456498",
		"3d8d65bd2f02dfc6b57f8b3e190334aeb5aab31e4abc6b6b003579bb4f456498",
		"48cb199f24d33f8ff8f811cdc2d90069f2ae322329e7e2f4b41d697dd0c1ab71",
		"8a004b053d3279b1746e862031a96aa068033c8b53a663a11d4d08f50c900d40"
	},
	{
		"ac1072f9a6cbebe456a254005f267a8c69a0b579134bcfc37ea6afb3bc75ea8a80057703b8db86f2982cd88bd188b41428fbc482e2a80f602ab42d3e0fb24517",
		"80057703b8db86f2982cd88bd188b41428fbc482e2a80f602ab42d3e0fb24517",
		"30c84bcc84f3ed0ac9b0b6798858478720a393e441cc37a5dc387192d60a104f",
		"de2bc570a702ba9f05688e84d395d29dabed63a44ff467310ad82043fe92353b"
	},
	{
		"b452b7ccc970fa8cd5c2ac28581b92b716d39a6c26233001576fc21f87194a0b1d7a7adc8183abdbe6c1e515f49470ca1df85018ba25990e6d3ec0d3fd03b27a",
		"1d7a7adc8183abdbe6c1e515f49470ca1df85018ba25990e6d3ec0d3fd03b27a",
		"50c994c0d669e39dbffc6a417222b64288eb8b7b3270ec4cd839947dacee5143",
		"5fee41f906935674b48ff17517fa118239a988d0c06f280d20cd8ddb5d8f4a03"
	},
	{
		"384eec1b6a467c3dd791f6e289f2fda31c54bd3f3240307274bcd4a93ac045db6a58e43fd5c28ee340652cab9abfa618cd8d756ac07089777bc0a646fa4273c1",
		"6a58e43fd5c28ee340652cab9abfa618cd8d756ac07089777bc0a646fa4273c1",
		"28619a87de8a39a8125fb46dce49ab99a118b540d4fd1d4394b38bb217e2945e",
		"ed4f92396c0e9a9905252409255484ddc67affaf9576614d376727f36e9ae25b"
	},
	{
		"d4a64734ab8571c5cf530b7dc4d1f366f561d3580861bf45784bb482a110a8746548d4fb729b26095ea8b8a946d39a1aa01a539361b8468bf15d0df7a5973590",
		"6548d4fb729b26095ea8b8a946d39a1aa01a539361b8468bf15d0df7a5973590",
		"88d0582e38dce1dde29f1a9ff07ba2decd4816aa94b099239d734c3ab1a48b6a",
		"bc9a957dd459ee1aff1dae372e74935e91e2b2483bcc84689df5afb0e4b2b07a"
	},
	{
		"07787fa1e0fefd41a8626bdf9f57f8e165150aa50153782ba41bf31ecac1916dd90f5686457b76f1f9de19340d360c4793c9577e743bf3e252013632dbc4e82a",
		"d90f5686457b76f1f9de19340d360c4793c9577e743bf3e252013632dbc4e82a",
		"70feb43e6cd03b72daa5f2b3d344d7854eec1cc83ace4fd79a6097dbbed44079",
		"86d9db0309708845895755bd866d36b152f88b96c622f13dd6ce3943d807a615"
	},
	{
		"fe2a03e2d7a9da41381c33badff8c877f282edace295dfcfe75cbcd4b75bb89eaddf889b430103c64109d1fe0e8cf1bd2456562c5e85562989d9a5a7771f91a6",
		"addf889b430103c64109d1fe0e8cf1bd2456562c5e85562989d9a5a7771f91a6",
		"08c183693db8bda356e2f7d503b9deddecb21baff9cf7e0f90d0a229ada4d85e",
		"ea90d6b85c10f47e9b4e3ca32614a04d82773772736d77bb3ef716198c499513"
	},
	{
		"26b67ca8ab1af541663392c0446b2b6352fd890effedbd0002a0110479fd4341ab220a8157fb1304d379c93627fd032742c25dd1cae889225f84885b80aab7b5",
		"ab220a8157fb1304d379c93627fd032742c25dd1cae889225f84885b80aab7b5",
		"40d0d25b75c26b6819b94ef4aae029906fefb712f46fcd28119cd2ccd058bc6d",
		"4dccb5f21aaad50662120061cef9219debe75a4717d67ef05488db4801864625"
	},
	{
		"9479f6242906bad8a814e11361acca31b3218dc8d71f9769abd783ce148a823b07654232a6fc7839f46bad7a52e78281fe453bdb7042b51b6ce2a9e191aeb546",
		"07654232a6fc7839f46bad7a52e78281fe453bdb7042b51b6ce2a9e191aeb546",
		"f83f45595178e5b0895c20760dc0929ab698cfa4115bf144d293b1b7a087ea77",
		"39ae5a0421d5e10889d3427531d17db80c5953adcd3b257a56744c27fcf14016"
	},
	{
		"0b8de383f28bd9a1a3d865dbf5e801bee147d6c1572d6ea7af553fdd4129a227c941f2c25309bfbddbdb011821ce62a2f078c582e2d9b354593dc2de597b14d8",
		"c941f2c25309bfbddbdb011821ce62a2f078c582e2d9b354593dc2de597b14d8",
		"209b02f6f2ea86e2c9fb8f67aaa797bd9bfa730f0edf8c8864490a70754b4171",
		"21d92b1bb99e46320f38f1c82bcb15bd2aa82a034f0511fb5a41f5eff5962c2b"
	},
	{
		"9062cf46e9bfa2caad30a81f23d3aefbb68e8b71351b8b7ced6cdb4a22277cb02b0e87baab89e0315e012043f79d0a231f71b6d914e62e7fc4da7f7f007e7a1e",
		"2b0e87baab89e0315e012043f79d0a231f71b6d914e62e7fc4da7f7f007e7a1e",
		"20e01da15fc58793cde29b7a11cc350f95d5d7a2de2b1ba8a064b96929558951",
		"1a4eb54cad60cedafd4ae033a5fe377964297a19d968789c2db92cd19d968443"
	},
	{
		"c02401a70bbdb76e8693bea23352735cd60812bb265e88c806b1811029144cb4d4a0ddaa96003e53e8047a5e7e37b2b2d47373a7a465859d6a19af777c17c78f",
		"d4a0ddaa96003e53e8047a5e7e37b2b2d47373a7a465859d6a19af777c17c78f",
		"80ffbf12eee2f436189d27d45f845547809fd462ad71126a691eb0394a61067b",
		"17c052a1a9a8d452d7dc5b981d21f97b6c7afb8ed21fdbe5abb99baa55402711"
	},
	{
		"2da81f302d8a7528afe2f0daadb3bf8a19174aa227366dc21c9d1a19cb7626a5bb33a907455a52de2511ac007d9a5710ae0349d9798aa1eb9db126d57ba86f4d",
		"bb33a907455a52de2511ac007d9a5710ae0349d9798aa1eb9db126d57ba86f4d",
		"e8a0908d639a93ed29352e66194969d84c15a59df0b269fe2ec5fe0e13fda450",
		"044f999abf497b3a652f92a3c36a493031d7659d614d6a4a6237379ffd9b4a29"
	},
	{
		"8de79930a17ba6c70fc74c20fa1950ecfcd013217d207064e9e806dd31e1bcbcdca48d6256d1ed908c9294d2431ae234dce87fc13c0f548fd2826cf504649060",
		"dca48d6256d1ed908c9294d2431ae234dce87fc13c0f548fd2826cf504649060",
		"f08e8f56a293e0ca7495f14f39f4d60bd342245d0ebd271204b2b5fb010ecd76",
		"c70ff6819528c8aae8d37975d78fc8506889bdc26d9114c7b3f7e2b8e22e0210"
	},
	{
		"79a4000c2f00f3a7a8ef97d7a9bb7f5ae02c0d60cb6de7d6ad0609120d6cfcfa57752e36ddb6736abe64f9209198ba8ce17e654d7466c325c7f6b295f28f8d13",
		"57752e36ddb6736abe64f9209198ba8ce17e654d7466c325c7f6b295f28f8d13",
		"085135d922e38d5960c878dd133646f011cd59643e0be07ae611eda1dd95824c",
		"1c5bfb41469a0f46742f27923693f3f9e14f7083a727ce7068b82f07f476916b"
	},
	{
		"221c6a68ff5295ac754996242e33f65032f5808d83cc7264859e6c019a8a1a533d09e383f285d717de3132ff79c0531320d38846394bec265551b2434dc77ccb",
		"3d09e383f285d717de3132ff79c0531320d38846394bec265551b2434dc77ccb",
		"9887d0a20266eefdc001f0b6ce33651cbeeb4a40039e8a809b8f5fdf97d2e24b",
		"92cb76ddcb8d926bfc365f05cd95c988749c0f307a444b6203a0deeda500eb10"
	},
	{
		"d97090ecaffcd493cc9295ff03eb8f496749ccd371a4c7cb3090e6b14b34889e982470a9bfb8db8463662949a966e7a6fb583029c31ac75e1cb1fb21c3aa0d2f",
		"982470a9bfb8db8463662949a966e7a6fb583029c31ac75e1cb1fb21c3aa0d2f",
		"c0b6e11d34cbc00a315312106282d687f03e00052bd6da8e44c707ee7a027f74",
		"1a4d8ef639e7547f660864a02688e26f2445e1826dd71d87f550f7eb42bed926"
	},
	{
		"9e54cf27583d9cb0f3c6fb930ee625ddaa471cf22a176601de6859980010daba0b51dd75a25a33488f718fa3860e0cdeb6495649ef5ecf15d1519c84b9dad344",
		"0b51dd75a25a33488f718fa3860e0cdeb6495649ef5ecf15d1519c84b9dad344",
		"50d70db0b2acd6441e4809e887a732ac79fbe03fe9f7cd8491914c57be275a6f",
		"59dcebe1cd3c355cd24eed1244c36e27f74be0d683d0bbd626a4aaf5efeae81e"
	},
	{
		"c415c816e8301b0f804d0894cf95b4fcb3c39c2d8def1556d8428726933c93bc6573dbcfdd4b3f41ad3ea4ca0cc2c94e3f0ad1b0af21852e4af2e87bfccb33c6",
		"6573dbcfdd4b3f41ad3ea4ca0cc2c94e3f0ad1b0af21852e4af2e87bfccb33c6",
		"68303ccb6bac0e5557a9e42052c617054c79878f96498c095b42a7ac61ba324e",
		"bcf14919825c46a58ce06c777e44211dd6d8776844f0c7d956879e3593e94576"
	},
	{
		"cd81ea39f0d023dcc1c1d98ca7249c0c1f5862477a4a4cf333b9623d2a7dc7b640b373e233e00cc9347a07fb9e8c6fd6d723c5ff5d9a35108a18c7222dbb6962",
		"40b373e233e00cc9347a07fb9e8c6fd6d723c5ff5d9a35108a18c7222dbb6962",
		"08cefc17fb3c696168a166cbc316cf3cfd668f734594abee94f1ad36dee4ed6a",
		"4fdc2106879ef2dfd3231998b92f7d79c7c15b20f7c64f5bdce60c347c48da17"
	},
	{
		"988886e2b7e6a2c5ba83508d500c09c483d334a1a911b114dcc2cfcb4266894e9103cf9f8048e711ee5b19e7a843bf348b5edfa93da4b1bfceca8b0c4bd771c8",
		"9103cf9f8048e711ee5b19e7a843bf348b5edfa93da4b1bfceca8b0c4bd771c8",
		"8063f5355795c0f672188333137b1dff23a40aed16ced6e8789a9f424cc1bf75",
		"c6173ece59fb0fa11bde55de3ce439f676d42be3ea312fca416130d935a3cb1d"
	},
	{
		"6eb10864ad2898d51dd762b9f3a39e4ce526442bdcb5217a763a287161171f8bae99a8661f4cdef84b4889b6b4beb95b0a98024d7e88acd1201a512bae11a094",
		"ae99a8661f4cdef84b4889b6b4beb95b0a98024d7e88acd1201a512bae11a094",
		"a0c539c70ce0c4a9212b1e4d7fd1973bc1ca8473c0b13cf56ee5e399a5553278",
		"d3a10f95aefac1e42d64a346b7c963652e5129cfbe70884a18bed781493bb448"
	},
	{
		"c76e9a8af962fae1ccd53728fff6bcbf26c7617c08ce23ec67a288e87d163ece6c4f8c2cbae4523e1bdc720e1b046e327a502a611a63d87de5357b355883ba09",
		"6c4f8c2cbae4523e1bdc720e1b046e327a502a611a63d87de5357b355883ba09",
		"a01b9031a08cb2da6c1d8bad20293975c51e4b47633622a79f52cb229256ea72",
		"497a63716842c8f0d26446621f28457df02333121c9e069a036b1d8194883d31"
	},
	{
		"c82591ec2fd01bc141d930be631d13ca8674d3f34ae28d2e393862ff9c335f1d93345d3bf2c7a3587dbb1aca81563894854565251ec765cdb3be4eae39e61463",
		"93345d3bf2c7a3587dbb1aca81563894854565251ec765cdb3be4eae39e61463",
		"70618e48fe0054b9bae329fe6b10a5785ae1d6bfbc73a7f0cf6eeaee0c29e350",
		"aeda1fc3e8ac82894b6d69a8429062468dc834ccf27a3e6680fd56bfb2a38d0c"
	},
	{
		"18d81a048f9affb7e57cb1911d2796f8ef43a18c3602b0928c189455a024a15ea944c70719ce554a5b0c9f571cfc4864de3e07b2af4fe2e1822d61be8b2c358b",
		"a944c70719ce554a5b0c9f571cfc4864de3e07b2af4fe2e1822d61be8b2c358b",
		"c84c2063ba3619d3165c9ab5c266bded03316dc8830503307416e13c90295a6d",
		"55d93114a4bcafea7f2a9ffc14f1294b143639733e679a8a8387e8c4ac306164"
	},
	{
		"28342c619b4ee9b3577e716574f6c3b6a29435bece15547a2aac3cc8a80cfd8a0047bb870660092ac92b682cdbcb9fda2578bee5e10e40deacccbd8292406f2f",
		"0047bb870660092ac92b682cdbcb9fda2578bee5e10e40deacccbd8292406f2f",
		"d0d26d29ca786b7b3e26e6cbdab32525faf357037f95a767da0739d573be8946",
		"110466af635ba45cd01f176605ded5cebc8d7465fcde4b4cd9be7b3e0f47e560"
	},
	{
		"bd423e0e59b76802ef439b34cb13c80232565319aebc0ae72ef0aff3c1e75ea78d45ac8ea8307b8c734d0d403f864903f9315b8c9e16933066159cc35c001e68",
		"8d45ac8ea8307b8c734d0d403f864903f9315b8c9e16933066159cc35c001e68",
		"40e69fa6d102e7f14af951c0e802fa201988ffc3609cfcbd901c2f660bffa86f",
		"7318927d1bb50c847c61be6e581e72c13668fba008e16ee533e5dba009c70a78"
	}
};

bool ed25519_to_curve25519_conversion_test()
{
    int32_t idx;
    bool result = true;
    uint8_t ed25519_sk[ED25519_PRIVATE_KEY_SIZE];
    uint8_t ed25519_pk[ED25519_PUBLIC_KEY_SIZE];
    uint8_t expected_curve25519_sk[CURVE25519_PRIVATE_KEY_SIZE];
    uint8_t expected_curve25519_pk[CURVE25519_PUBLIC_KEY_SIZE];
    uint8_t curve25519_sk[CURVE25519_PRIVATE_KEY_SIZE];
    uint8_t curve25519_pk[CURVE25519_PUBLIC_KEY_SIZE];
    uint8_t computed_pk[CURVE25519_PUBLIC_KEY_SIZE];
    ed25519_curve25519_test_vectors *ptr = NULL;

    for (idx = 0;
         result && idx < (int)(sizeof(test_vectors) / sizeof(ed25519_curve25519_test_vectors));
         idx++)
    {
        result = false;
        ptr = &test_vectors[idx];

		crypto_memzero(curve25519_sk, CURVE25519_PRIVATE_KEY_SIZE);
		crypto_memzero(curve25519_pk, CURVE25519_PUBLIC_KEY_SIZE);
		crypto_memzero(computed_pk, CURVE25519_PUBLIC_KEY_SIZE);

        hex_string_to_byte_array(ed25519_sk, ptr->ed25519_sk_hex);
        hex_string_to_byte_array(ed25519_pk, ptr->ed25519_pk_hex);
        hex_string_to_byte_array(expected_curve25519_sk, ptr->curve25519_sk_hex);
        hex_string_to_byte_array(expected_curve25519_pk, ptr->curve25519_pk_hex);

        ed25519_to_curve25519_private_key(curve25519_sk, ed25519_sk);
        if (0 != memcmp(expected_curve25519_sk, curve25519_sk, CURVE25519_PRIVATE_KEY_SIZE))
        {
            break;
        }

        if (0 != ed25519_to_curve25519_public_key(curve25519_pk, ed25519_pk))
		{
			break;
		}
        if (0 != memcmp(expected_curve25519_pk, curve25519_pk, CURVE25519_PUBLIC_KEY_SIZE))
        {
            break;
        }

        if (false == curve25519_public_key_from_private_key(computed_pk, curve25519_sk))
		{
			break;
		}
        result = (0 == memcmp(expected_curve25519_pk, computed_pk, CURVE25519_PUBLIC_KEY_SIZE));
    }

    return result;
}

bool ed25519_to_curve25519_random_conversion_test(int iterations)
{
    int32_t i, idx;
    bool result = true;
    uint8_t ed25519_sk[ED25519_PRIVATE_KEY_SIZE];
    uint8_t ed25519_pk[ED25519_PUBLIC_KEY_SIZE];
    uint8_t curve25519_sk[CURVE25519_PRIVATE_KEY_SIZE];
    uint8_t curve25519_pk[CURVE25519_PUBLIC_KEY_SIZE];
    uint8_t computed_pk[CURVE25519_PUBLIC_KEY_SIZE];

    for (idx = 0; result && idx < iterations; ++idx)
    {
        result = false;

    	crypto_memzero(ed25519_sk, ED25519_PRIVATE_KEY_SIZE);
    	crypto_memzero(ed25519_pk, ED25519_PUBLIC_KEY_SIZE);
		crypto_memzero(curve25519_sk, CURVE25519_PRIVATE_KEY_SIZE);
		crypto_memzero(curve25519_pk, CURVE25519_PUBLIC_KEY_SIZE);
		crypto_memzero(computed_pk, CURVE25519_PUBLIC_KEY_SIZE);

		ed25519_keypair(ed25519_pk, ed25519_sk);

		ed25519_to_curve25519_private_key(curve25519_sk, ed25519_sk);

        if (0 != ed25519_to_curve25519_public_key(curve25519_pk, ed25519_pk))
		{
			printf("\nPublic-key conversion failed\n");
			printf("ed25519_sk: ");
			for (i = 0; i < ED25519_PRIVATE_KEY_SIZE; i++)
			{
				printf("%02x", ed25519_sk[i]);
			}
			printf("\n");
			result = false;
			break;
		}										  

        if (false == curve25519_public_key_from_private_key(computed_pk, curve25519_sk))
		{
			printf("\nCurve25519 public-key derivation failed\n");
			printf("ed25519_sk: ");
			for (i = 0; i < ED25519_PRIVATE_KEY_SIZE; i++)
			{
				printf("%02x", ed25519_sk[i]);
			}
			printf("\n");
			result = false;
			break;
		}				
        result = (0 == memcmp(curve25519_pk, computed_pk, CURVE25519_PUBLIC_KEY_SIZE));
	}

	return result;
}
